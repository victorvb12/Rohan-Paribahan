<body>
<nav>
  <div class="logo">Rohan Paribahan</div>

  <div class="nav-links" id="navLinks">
    <a href="addrickshaw.html">Manage Rickshaws</a>
    <a href="addincome.html">Add Income</a>
    <a href="addexpense.html">Add Expense</a>
    <a href="report.html">Reports</a>
    <a href="#" onclick="logout()" style="color:#ffcccc;">Logout</a>
  </div>

  <div class="hamburger" onclick="toggleMenu()">
    <div></div>
    <div></div>
    <div></div>
  </div>

  <div class="mobile-menu" id="mobileMenu">
    <a href="addrickshaw.html">Manage Rickshaws</a>
    <a href="addincome.html">Add Income</a>
    <a href="addexpense.html">Add Expense</a>
    <a href="report.html">Reports</a>
    <a href="#" onclick="logout()">Logout</a>
  </div>
</nav>

<main id="mainContent" style="display: none;">
  <h1>Dashboard</h1>
  <p style="text-align:center;">Welcome to the Rickshaw Income Tracker Dashboard!</p>

  <h2>Rickshaw Stats</h2>
  <div id="statsList"></div>
</main>

<!-- Login Form -->
<div id="loginBox" style="max-width: 400px; margin: 60px auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: none;">
  <h2 style="text-align: center; color: #007bff;">Admin Login</h2>
  <form id="loginForm">
    <label for="email">Email:</label><br>
    <input type="email" id="email" required placeholder="admin@rohan.com" style="width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 6px; border: 1px solid #ccc;"><br>

    <label for="password">Password:</label><br>
    <input type="password" id="password" required placeholder="********" style="width: 100%; padding: 10px; margin-bottom: 20px; border-radius: 6px; border: 1px solid #ccc;"><br>

    <button type="submit" style="width: 100%; background: #007bff; color: white; padding: 12px; border: none; border-radius: 6px; font-weight: bold;">Login</button>
  </form>
</div>

<script>
  function toggleMenu() {
    document.getElementById("mobileMenu").classList.toggle("show");
  }

  function logout() {
    localStorage.removeItem('isLoggedIn');
    location.reload();
  }

  const rickshaws = JSON.parse(localStorage.getItem('rickshaws') || '[]');
  const incomes = JSON.parse(localStorage.getItem('incomes') || '[]');
  const statsList = document.getElementById('statsList');
  const loginBox = document.getElementById('loginBox');
  const mainContent = document.getElementById('mainContent');
  const navLinks = document.getElementById('navLinks');

  // Check login status
  const isLoggedIn = localStorage.getItem('isLoggedIn');
  if (isLoggedIn === 'true') {
    showDashboard();
  } else {
    loginBox.style.display = 'block';
    navLinks.style.display = 'none';
  }

  // Handle login
  document.getElementById('loginForm').addEventListener('submit', function (e) {
    e.preventDefault();
    const email = document.getElementById('email').value.trim();
    const pass = document.getElementById('password').value.trim();

    if (email === 'admin@rohan.com' && pass === 'rickshawrohan') {
      localStorage.setItem('isLoggedIn', 'true');
      location.reload();
    } else {
      alert('Invalid email or password');
    }
  });

  function showDashboard() {
    loginBox.style.display = 'none';
    mainContent.style.display = 'block';
    navLinks.style.display = 'flex';

    if (rickshaws.length === 0) {
      statsList.innerHTML = '<p class="no-data">No rickshaws found.</p>';
    } else {
      rickshaws.forEach(rick => {
        const totalIncome = incomes
          .filter(income => income.plate === rick.plate)
          .reduce((sum, i) => sum + Number(i.amount || 0), 0);

        const investment = Number(rick.investment || 0);
        const remaining = totalIncome - investment;

        const card = document.createElement('div');
        card.className = 'rickshaw-card';
        card.innerHTML = `
          <strong>Plate:</strong> <span>${rick.plate}</span><br>
          <strong>Investment:</strong> <span>৳${investment.toLocaleString()}</span><br>
          <strong>Lifetime Earn:</strong> <span>৳${totalIncome.toLocaleString()}</span><br>
          <strong>Remaining:</strong> <span class="${remaining >= 0 ? 'positive' : 'negative'}">৳${remaining.toLocaleString()}</span>
        `;
        statsList.appendChild(card);
      });
    }
  }
</script>
</body>
